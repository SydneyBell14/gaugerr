test_that("conf_intervals works", {
  expect_error(conf_intervals(2))
  expect_equal(conf_intervals(data1), data.frame(
    quantity = c("s2_repeat","s2_p","s2_o", "s2_po","s2_tot", "s2_repro", "s2_gauge", "pg_ratio","tg_ratio", "pr_ratio"),
    estimate = c(0.51111111, 48.29259259, 0.56460905, 0.72798354, 50.09629630, 1.29259259, 1.80370370, 26.77412731, 0.03600473, 94.48550725),
    lower = c(0.368157535, 22.694519080, 0.072961525, 0.332725386, 24.488435035, 0.612491664, 1.206225574, 1.691679513, 0.009380075, 40.191991368),
    upper = c(0.7575430, 161.6391842, 25.7507696, 1.7927202, 166.2221729, 26.4986366, 27.0172388, 105.6089534, 0.3715153, 327.3236992)
  ))
  expect_equal(conf_intervals(data2), data.frame(
    quantity = c("s2_repeat","s2_p","s2_o", "s2_po","s2_tot", "s2_repro", "s2_gauge", "pg_ratio","tg_ratio", "pr_ratio"),
    estimate = c(0.011623692, 0.004698568, 0.003082644, 0.0, 0.014261076, 0.0, 0.009562508, 0.49135309, 0.670532018, 0.404223385),
    lower = c(0.00989599928, 0.00209033003, 0.00168759268, 0.0, 0.01096507653, 0.0, 0.00753059653, 0.18448324835, 0.29739184874, 0.17602446785),
    upper = c(0.013849510, 0.021885394, 0.008734458, 0.001312970, 0.032452416, 0.005737704, 0.015562292, 2.362566944, 0.844250015, 1.891743810)
  ))
})
