test_that("mean_ss function works", {
  data1 <- data.frame(P=c(1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,
                          4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,
                          7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,
                          10,10,10,10,10,10,10,10,10),
                      Y=c(37,38,37,41,41,40,41,42,41,42,41,43,42,42,42,43,42,43,
                          30,31,31,31,31,31,29,30,28,42,43,42,43,43,43,42,42,42,
                          28,30,29,29,30,29,31,29,29,42,42,43,45,45,45,44,46,45,
                          25,26,27,28,28,30,29,27,27,40,40,40,43,42,42,43,43,41,
                          25,25,25,27,29,28,26,26,26,35,34,34,35,35,34,35,34,35),
                      O=c(1,1,1,2,2,2,3,3,3,1,1,1,2,2,2,3,3,3,1,1,1,2,2,2,3,3,3,
                          1,1,1,2,2,2,3,3,3,1,1,1,2,2,2,3,3,3,1,1,1,2,2,2,3,3,3,
                          1,1,1,2,2,2,3,3,3,1,1,1,2,2,2,3,3,3,1,1,1,2,2,2,3,3,3,
                          1,1,1,2,2,2,3,3,3))
  expect_equal(mean_ss(data1), data.frame("SSP"=437.3284, "SSO"=19.6333333, "SSE"=0.51111111, "MSPO"=2.6950617))
  expect_error(mean_ss("cat"))
})
